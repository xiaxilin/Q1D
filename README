Quasi-1D Nozzle Suite

Executables: q1d, g1d_grid, q1d_exact q1d_dual

q1d_grid  : grid generator
q1d       : primal solver
q1d_exact : exact primal solution
q1d_dual  : dual solver

Written in Fortran 9X by Joe Derlaga

This directory includes a suite of codes to study the Quasi-1D Nozzle problem.

The heart of the suite, q1d, 
is a FVM code with a multistep Runge-Kutta explicit solver.
When running Euler explicit, local time stepping is used,
while any of the RK schemes force global time stepping for stability.

The code defaults to a first order mode, but second order is reach via
MUSCL extrapolation of primitive variables.
A variety of flux schemes and variable limiters are available:

Flux schemes:
Central Difference ( unstable, included for rigor! )
Cent. Diff + JST Damping
Roe's FDS
van Leer FVS
Steger-Warming FVS
AUSM
HLLC ( to be added! )

Variable limiters:
OSPRE
van Albada
van Leer
Sweby
minmod
superbee

Due to the modularity of the code, it is a simple matter to add additional
flux schemes or variable limiters

The code requires that the number of interior cells, N, be specified,
however, two additional cells, cell(1) and cell(N+2), are ghost cells,
while the interior domain is contained by cell(2,N+1).
Since there are N interior cells, there are N+1 faces.
Hopefully the below diagram explains this:

DOMAIN: inflow |        interior        | outflow
       -----------------------------------------
CELLS:     1   |   2   | ...... |  N+1  |  N+2
       -----------------------------------------
FACES:         1       2        N      N+1

Where appropriate, the code will loop over faces, 
such as when it is calculating fluxes, or over cells, 
such as when the explicit iteration is being performed.

To build, execute the following:

prompt% ./bootstrap
prompt% ./configure FC=gfortran FCFLAGS="-O2"
prompt% make

Once you've set up a grid by running ./q1d_grid,
set up the q1d.nml input file, and execute ./q1d

Files:

  q1d.nml == input file
  q1d.grd == grid file

  q1d.rst == restart file
  q1d.hst == convergence history file

  q1d_lines.tec == tecplot XY formatted data file
  q1d_cells.tec == tecplot cell-centered color plot file

This code is under development!
Once the explicit code base is up to standard,
an implicit solver will be implemented, followed by an adjoint code.

The implicit path, and the dual solver, 
will only allow for Roe's FDS and van Leer FVS!

Example unit-tests will be added.

Coding standard:
80 column line limit for readability
No tabs, only spaces for indentation, run untabify in emacs
No trailing whitespace
Try to avoid CAPS, except in comments, 
and where differentiating between 1, l, I, L are important.